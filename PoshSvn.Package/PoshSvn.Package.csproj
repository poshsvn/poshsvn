<Project Sdk="Microsoft.Build.NoTargets/3.7.56">

  <PropertyGroup>
    <TargetFramework>net4.7.2</TargetFramework>
    <PackagePath>$(SolutionDir)\bin\poshsvn\</PackagePath>
    <ZipPackagePath>$(SolutionDir)\bin\poshsvn.zip</ZipPackagePath>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\PoshSvn.Docs\PoshSvn.Docs.csproj" />
    <ProjectReference Include="..\PoshSvn\PoshSvn.csproj" />
  </ItemGroup>

  <ItemGroup>
    <FilesToCopy Include="$(OutDir)*.ps1xml" />
    <FilesToCopy Include="$(OutDir)PoshSvn.psd1" />

    <FilesToCopy Include="$(OutDir)\en-US\**\*" Destination="en-US" />
    <FilesToCopy Include="$(OutDir)\fr-FR\**\*" Destination="fr-FR" />

    <FilesToCopy Include="$(OutDir)\PoshSvn.dll" />
    <FilesToCopy Include="$(OutDir)\SharpSvn.dll" />

    <FilesToCopy Include="$(OutDir)vcruntime140.dll" />
    <FilesToCopy Include="$(OutDir)vcruntime140_1.dll" />

    <FilesToCopy Include="$(OutDir)libsvn_wc-1.dll" />
    <FilesToCopy Include="$(OutDir)sqlite3.dll" />
    <FilesToCopy Include="$(OutDir)zlib1.dll" />
    <FilesToCopy Include="$(OutDir)libapr-1.dll" />
    <FilesToCopy Include="$(OutDir)libaprutil-1.dll" />
    <FilesToCopy Include="$(OutDir)libcrypto-3-x64.dll" />
    <FilesToCopy Include="$(OutDir)libexpat.dll" />
    <FilesToCopy Include="$(OutDir)libssl-3-x64.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_client-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_delta-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_diff-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_fs_fs-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_fs_util-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_fs_x-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_fs-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_ra-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_repos-1.dll" />
    <FilesToCopy Include="$(OutDir)libsvn_subr-1.dll" />
  </ItemGroup>

  <Target Name="CopyFiles" BeforeTargets="AfterBuild">
    <Copy SourceFiles="@(FilesToCopy)" DestinationFolder="$(PackagePath)%(FilesToCopy.Destination)%(RecursiveDir)" />
  </Target>

  <Target Name="ZipPackage" AfterTargets="CopyFiles" Inputs="@(FilesToCopy)" Outputs="$(ZipPackagePath)">
    <ZipDirectory SourceDirectory="$(PackagePath)" DestinationFile="$(ZipPackagePath)" Overwrite="true" />
  </Target>

</Project>
